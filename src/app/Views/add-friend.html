<app-header title="Add Friend" i18n-title="@@AddFriend" returnButton="true"></app-header>
<div class="search-part">
    <input placeholder="Enter your friend's nickname" type="text" #friendSearch />
</div>
<div class="search-holder"></div>

<div class="buttons">
    <button *ngIf="!searching" class="button primary" (click)="search(friendSearch.value, 0)">Search</button>
    <button *ngIf="searchMode == 1 && searching" class="button primary" disabled>Searching</button>
</div>

<div class="result" *ngIf="results">
    <div class="selectResult result" (click)="showUsersResults(true)" [ngClass]="{ 'selected': showUsers }">
        <div class="sender">Users</div>
        <div *ngIf="results.usersCount >= 0 && results.usersCount < 100" class="dot bluedot">
            {{results.usersCount}}
        </div>
        <div *ngIf="results.usersCount > 99" class="dot bluedot">
            99+
        </div>
    </div>
    <div class="selectResult result" (click)="showUsersResults(false)" [ngClass]="{ 'selected': !showUsers }">
        <div class="sender">Groups</div>
        <div *ngIf="results.groupsCount >= 0 && results.groupsCount < 100" class="dot bluedot">
            {{results.groupsCount}}
        </div>
        <div *ngIf="results.groupsCount > 99" class="dot bluedot">
            99+
        </div>
    </div>
</div>

<div *ngIf="showUsers && results">
    <div class="result" *ngFor="let user of results.users" routerLink="/user/{{ user.id }}">
        <img class="user-img" src="{{user.avatarURL ? user.avatarURL : loadingImgURL}}?w=80&h=80" />
        <div class="sender">
            {{user.nickName}}
        </div>
    </div>
</div>

<div *ngIf="!showUsers && results">
    <div class="result" *ngFor="let group of results.groups" (click)="joinGroup(group)">
        <div class="searchGroupIamge">
            <img class="user-img" src="{{group.avatarURL ? group.avatarURL : loadingImgURL}}?w=80&h=80" />
            <i class="fa fa-lock" aria-hidden="true" *ngIf="group.hasPassword"></i>
        </div>
        <div class="sender">
            {{group.name}}
        </div>
    </div>
</div>

<div class="buttons" *ngIf="results && ((showUsers && results.usersCount >= 0 && results.users.length < results.usersCount) || (!showUsers && results.groupsCount >= 0 && results.groups.length < results.groupsCount))">
    <button *ngIf="!searching" class="button primary" (click)="search(friendSearch.value, 1)">Load More</button>
    <button *ngIf="searchMode == 1 && searching" class="button primary" disabled>Loading</button>
</div>
